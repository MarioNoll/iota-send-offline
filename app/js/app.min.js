!function(){return function e(t,n,i){function r(o,a){if(!n[o]){if(!t[o]){var d="function"==typeof require&&require;if(!a&&d)return d(o,!0);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){return r(t[o][1][e]||e)},u,u.exports,e,t,n,i)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}}()({1:[function(e,t,n){!function(e,t){const n=new t.IOTA;e.fn.form.settings.rules.isAddress=function(e){return n.valid.isAddress(e)},e.fn.form.settings.rules.hasChecksum=function(e){return 90===e.length},e.fn.form.settings.rules.isValidChecksum=function(e){return n.valid.isAddress(e)&&n.utils.isValidChecksum(e)},e.fn.form.settings.rules.isSeed=function(e){return n.valid.isTrytes(e,81)},e.fn.form.settings.rules.isGreaterZero=function(e){return Number(e)>0},e.fn.form.settings.rules.isBalanceSufficient=function(t){let i=e("#step2InputForm").form("get value","textAreaStep2RawInformation");i=JSON.parse(i),t=Number(t);const r=e("#dropDownValueUnit").dropdown("get value");return(t=n.utils.convertUnits(t,r,"i"))<=i.balance-i.proxy.fee},e.fn.form.settings.rules.isRawInformationValid=function(e){try{const t=JSON.parse(e),i=n.valid.isAddress(t.fromAddress)&&n.utils.isValidChecksum(t.fromAddress),r=Number.isInteger(t.security)&&t.security>=1&&t.security<=3,s=Number.isInteger(t.balance),o=n.valid.isAddress(t.proxy.address)&&n.utils.isValidChecksum(t.proxy.address),a=n.valid.isTrytes(t.proxy.tag,27),d=Number.isInteger(t.proxy.fee);return i&&r&&s&&o&&a&&d}catch(e){return!1}}}(jQuery,window)},{}],2:[function(e,t,n){e("./util"),e("./form.validation"),e("./step1"),e("./step2"),e("./step3")},{"./form.validation":1,"./step1":3,"./step2":4,"./step3":5,"./util":6}],3:[function(e,t,n){!function(e,t){let n;function i(){e("#generateInfoErr").addClass("hidden")}function r(t){n.abortAll(),e("#generateInfoErr").removeClass("hidden"),e("#btnGenInfo").removeClass("loading disabled"),e("#generateInfoErrMsg").html(t)}e("#step1InputForm").on("input",function(r){n=n||t.createXhrPool(),function(){n.abortAll(),i(),function(){const n=e("#step1InputForm").form("get value","inputStep1FromAddress");e.fn.form.settings.rules.isAddress(n)?(e("#btnExploreFromAddress").removeClass("disabled"),e("#btnExploreFromAddress").attr("href",t.addressUrl+n)):(e("#btnExploreFromAddress").addClass("disabled"),e("#btnExploreFromAddress").attr("href",""))}(),e("#btnGenInfo").removeClass("loading disabled"),e("#infoContainer").transition("is visible")&&!e("#infoContainer").transition("is animating")?e("#infoContainer").transition("fade up"):e("#infoContainer").transition("hide")}()}),e("#step1InputForm").form({inline:!0,on:"blur",fields:{fromAddress:{identifier:"inputStep1FromAddress",rules:[{type:"isAddress",prompt:"Please enter a valid address"},{type:"hasChecksum",prompt:"Address checksum missing"},{type:"isValidChecksum",prompt:"Invalid checksum"}]}},onSuccess:function(s){s.preventDefault(),e("#btnGenInfo").hasClass("disabled")||e("#btnGenInfo").hasClass("loading")||function(){e("#btnGenInfo").addClass("loading disabled"),i();const s=e("#step1InputForm").form("get value","inputStep1FromAddress"),o=new t.IOTA({host:"https://field.carriota.com",port:443});function a(){o.api.getBalances([s],100,function(i,o){if(i)r("Failed to retrieve balance for given address.");else{const i=Number(o.balances[0]);!function(i){e.ajax({type:"post",url:t.twapi+"/tx-schemas",crossDomain:!0,dataType:"json",beforeSend:function(e){n.push(e)},complete:function(e){n.remove(e)},success:function(o){"success"===o.status?function(i,r){t.getPrice(n,function(n,o){const a=t.iotaToUSD(i,o),d=t.iotaToUSD(r.iota,o);e("#inputGenBalanceTag").text(a),e("#inputGenFeeTag").text(d);const l=t.formatIota(i);e("#inputGenBalance").val(l);const u=t.formatIota(r.iota);e("#inputGenFee").val(u);const c={fromAddress:s,security:2,balance:i,proxy:{address:r.address,tag:r.tag,fee:r.iota}};e("#textAreaStep1RawInformation").text(JSON.stringify(c)),function(){e("#btnGenInfo").removeClass("loading"),e("#infoContainer").transition("is animating")||e("#infoContainer").transition("is visible")?e("#infoContainer").transition("show"):e("#infoContainer").transition("fade down")}()})}(i,o.data.schema):r("Failed to get proxy information. Please try again later.")},error:function(e,t){r("Failed to get proxy information. Please try again later.")}})}(i)}})}o.api.wereAddressesSpentFrom([s],function(e,t){return e?r(e):t.some(e=>e)?r('Private Key Reuse Prohibited. <a href="https://iota.readme.io/docs/seeds-private-keys-and-accounts#section-private-keys-and-addresses" target="_blank">Read more.</a>'):void a()})}()}}),e("#textAreaStep1RawInformation").focus(t=>e(t.target).select())}(jQuery,window)},{}],4:[function(e,t,n){!function(e,t){const n=new t.IOTA;let i=!1;function r(){s(),function(){e("#txContainer").transition("is animating")||!e("#txContainer").transition("is visible")?e("#txContainer").transition("hide"):e("#txContainer").transition("fade up")}(),e("#btnCreateTx").removeClass("loading disabled"),e("#createTxWarning").transition("hide"),i=!0}function s(){e("#createTxErr").addClass("hidden")}function o(t){e("#createTxErr").removeClass("hidden"),e("#btnCreateTx").removeClass("loading disabled"),e("#createTxErrMsg").text(t)}e("#step2InputForm").on("input",function(e){r()}),e("#inputSeed").on("input",function(t){const i=e("#step2InputForm").form("get value","inputSeed"),r=e.fn.form.settings.rules.isSeed(i)?n.utils.addChecksum(i,3,!1).substr(-3):"---";e("#seedChecksum").text(r)}),e("#dropDownValueUnit").dropdown({action:function(t,n){e("#dropDownValueUnit").dropdown("set text",n),e("#dropDownValueUnit").dropdown("set selected",n),e("#dropDownValueUnit").dropdown("hide"),e("#step2InputForm").form("validate field","value")},values:[{name:"i",value:"i"},{name:"Ki",value:"Ki"},{name:"Mi",value:"Mi",selected:!0},{name:"Gi",value:"Gi"},{name:"Ti",value:"Ti"}]}),e("#step2InputForm").form({inline:!0,on:"blur",fields:{step1Info:{identifier:"textAreaStep2RawInformation",rules:[{type:"isRawInformationValid",prompt:"Invalid Information! Paste Raw Information from Step 1 here."}]},value:{identifier:"inputValue",depends:"textAreaStep2RawInformation",rules:[{type:"empty",prompt:"Value must not be empty"},{type:"number",prompt:"Please enter a valid number"},{type:"isGreaterZero",prompt:"Please enter a valid number"},{type:"isBalanceSufficient",prompt:"Not enough balance on address"}]},toAddress:{identifier:"inputToAddress",rules:[{type:"isAddress",prompt:"Please enter a valid address"},{type:"hasChecksum",prompt:"Address checksum is missing"},{type:"isValidChecksum",prompt:"Invalid checksum"}]},seed:{identifier:"inputSeed",rules:[{type:"isSeed",prompt:"Please enter a valid seed"}]}},onSuccess:function(r){r.preventDefault(),e("#btnCreateTx").hasClass("disabled")||e("#btnCreateTx").hasClass("loading")||function(){e("#btnCreateTx").addClass("loading disabled"),s(),i=!1;let r=e("#step2InputForm").form("get value","textAreaStep2RawInformation");r=JSON.parse(r);const a=n.utils.noChecksum(r.fromAddress),d=e("#dropDownValueUnit").dropdown("get value");let l=e("#step2InputForm").form("get value","inputValue");l=n.utils.convertUnits(l,d,"i");const u=e("#step2InputForm").form("get value","inputToAddress"),c=e("#step2InputForm").form("get value","inputSeed");function f(s){n.api.getNewAddress(c,{index:s,total:1,security:r.security},function(d,m){if(d)return o(d);m[0]!==a?setTimeout(function(){!i&&function(t){if((t+1)%16==0)return function(){e("#createTxWarning").transition("is visible")?e("#createTxWarning").transition("show"):e("#createTxWarning").transition("fade");e("#btnCreateTx").removeClass("loading"),e("#createTxWarningMsg").html("Address calculation is taking longer then usual. Current index: "+t+"<br>Consult the help page to see why this can happen.")}(),e("#createTxInfoBtnContinue").unbind().click(function(n){!function(){e("#createTxWarning").transition("hide"),e("#btnCreateTx").addClass("loading")}(),setTimeout(function(){f(++t)},200)}),!1;return!0}(s)&&f(++s)},50):function(e){const i=[{address:a,balance:r.balance,security:r.security,keyIndex:e}],s=[{address:n.utils.noChecksum(r.proxy.address),value:r.proxy.fee,tag:r.proxy.tag},{address:n.utils.noChecksum(u),value:l,tag:t.defaultTag}];!function(e,i){const s=r.balance-r.proxy.fee-l;if(0!==s){const a=e[0].keyIndex+1;n.api.getNewAddress(c,{index:a,total:1,security:r.security},function(n,r){if(n)return o(n);i.push({address:r[0],value:s,tag:t.remainderTag}),p(e,i)})}else p(e,i)}(i,s)}(s)})}function p(i,r){const s=new t.Bundle,o=function(){let e="";for(let t=0;e.length<2187;t++)e+="9";return e}(),a=[];for(let e=0;e<r.length;e++){a.push(o);const t=Math.floor(Date.now()/1e3);s.addEntry(1,r[e].address,r[e].value,r[e].tag,t)}for(let e=0;e<i.length;e++){const n=Math.floor(Date.now()/1e3);s.addEntry(i[e].security,i[e].address,0-i[e].balance,t.defaultTag,n)}s.finalize(),s.addTrytes(a);for(let e=0;e<s.bundle.length;e++)if(s.bundle[e].value<0){const n=s.bundle[e].address;let r,o;for(let e=0;e<i.length;e++)if(i[e].address===n){r=i[e].keyIndex,o=i[e].security;break}const a=s.bundle[e].bundle,d=t.Signing.key(t.Converter.trits(c),r,o),l=s.normalizedBundle(a),u=[];for(let e=0;e<3;e++)u[e]=l.slice(27*e,27*(e+1));const f=d.slice(0,6561),p=u[0],m=t.Signing.signatureFragment(p,f);s.bundle[e].signatureMessageFragment=t.Converter.trytes(m);for(let i=1;i<o;i++)if(s.bundle[e+i].address===n&&0===s.bundle[e+i].value){const n=d.slice(6561*i,6561*(i+1)),r=u[i],o=t.Signing.signatureFragment(r,n);s.bundle[e+i].signatureMessageFragment=t.Converter.trytes(o)}}const d=[];s.bundle.forEach(function(e){d.push(n.utils.transactionTrytes(e))}),e("#textAreaRawTransaction").text(JSON.stringify({inputs:i,transfers:r})),e("#textAreaSignedTransaction").text(JSON.stringify(d)),function(){e("#btnCreateTx").removeClass("loading"),e("#txContainer").transition("is animating")||e("#txContainer").transition("is visible")?e("#txContainer").transition("show"):e("#txContainer").transition("fade down")}()}setTimeout(function(){f(0)},50)}()}}),e("#btnValueMax").click(function(){if(!e("#step2InputForm").form("is valid","step1Info"))return;let t=e("#step2InputForm").form("get value","textAreaStep2RawInformation");t=JSON.parse(t);const i=e("#dropDownValueUnit").dropdown("get value");let r=Math.max(t.balance-t.proxy.fee,0);r=n.utils.convertUnits(r,"i",i),e("#inputValue").val(r),0!==r&&e("#step2InputForm").form("validate field","value")}),e("#textAreaStep2RawInformation").focus(t=>e(t.target).select()),e("#textAreaSignedTransaction").focus(t=>e(t.target).select()),e("#textAreaSignedTransaction").dblclick(t=>e(t.target).select()),e("#createTxInfoBtnCancel").click(function(e){r()})}(jQuery,window)},{}],5:[function(e,t,n){!function(e,t){let n;const i=new t.IOTA({host:"https://field.carriota.com",port:443});function r(){const r=e("#step3InputForm").form("get value","textAreaStep3SignedTransaction"),o=function(e){try{e=JSON.parse(e);const t=[];for(let n=0;n<e.length;n++){let r=i.utils.transactionObject(e[n]);t.push(r)}return!!i.utils.isBundle(t)&&t}catch(e){return!1}}(r);if(!o)return e("#btnSendTransaction").removeClass("loading disabled"),void s();!function(r,s){t.getPrice(n,function(o,l){e("#btnSendTransaction").removeClass("loading disabled");for(let n=0;n<s.length;n++)if(s[n].tag.includes(t.workerTagPrefix)){const i=t.formatIota(s[n].value),r=t.iotaToUSD(s[n].value,l);e("#confirmFee").val(i),e("#confirmFeeTag").text(r)}else if(s[n].tag.includes(t.remainderTag)){const r=i.utils.addChecksum(s[n].address);e("#confirmRemainderAddress").val(r),e("#btnExploreConfirmRemainderAddress").attr("href",t.addressUrl+r)}else if(s[n].value<0){const r=i.utils.addChecksum(s[n].address);e("#confirmFromAddress").val(r),e("#btnExploreConfirmFromAddress").attr("href",t.addressUrl+r)}else if(s[n].value>0){const r=t.formatIota(s[n].value),o=t.iotaToUSD(s[n].value,l);e("#confirmValue").val(r),e("#confirmValueTag").text(o);const a=i.utils.addChecksum(s[n].address);e("#confirmToAddress").val(a),e("#btnExploreConfirmToAddress").attr("href",t.addressUrl+a)}e("#confirmModal").modal({closable:!1,blurring:!0}).modal("show"),e("#btnConfirmSubmit").unbind().click(function(i){e("#btnConfirmSubmit").addClass("loading disabled"),e("#btnConfirmCancel").addClass("disabled"),function(i,r){e.ajax({type:"post",url:t.twapi+"/bundles",crossDomain:!0,contentType:"application/json",data:i,dataType:"json",beforeSend:function(e){n.push(e)},complete:function(e){n.remove(e)},success:function(n){"success"===n.status?function(n){a(),e("#bundleHashSuccess").val(n),e("#btnExploreBundleHashSuccess").attr("href",t.bundleUrl+n),e("#successModal").modal({closable:!1,blurring:!0}).modal("show")}(r):d("Failed to send transaction to proxy. Please try again later.")},error:function(n,i){if(409===n.status)!function(n){a(),e("#bundleHashDuplicate").val(n),e("#btnExploreBundleHashDuplicate").attr("href",t.bundleUrl+n),e("#duplicateModal").modal({closable:!1,blurring:!0}).modal("show")}(r);else if(400===n.status||401===n.status){const e=JSON.parse(n.responseText);d(e.data)}else d("Failed to send transaction to proxy. Please try again later.")}})}(r,s[0].bundle)})})}(r,o)}function s(t){t?e("#step3InputForm").form("add prompt","textAreaStep3SignedTransaction","Paste Signed Transaction from Step 2 here."):e("#step3InputForm").form("add prompt","textAreaStep3SignedTransaction","Invalid Transaction! Paste Signed Transaction from Step 2 here.")}function o(){e("#sendTxErr").addClass("hidden")}function a(){e("#btnConfirmSubmit").removeClass("loading disabled"),e("#btnConfirmCancel").removeClass("disabled")}function d(t){a(),e("#confirmModal").modal("hide"),n.abortAll(),e("#sendTxErr").removeClass("hidden"),e("#btnSendTransaction").removeClass("loading disabled"),e("#sendTxErrMsg").text(t)}e("#step3InputForm").on("input",function(i){n=n||t.createXhrPool(),function(){n.abortAll(),o(),e("#btnSendTransaction").removeClass("loading disabled")}()}),e("#textAreaStep3SignedTransaction").keypress(function(t){if(13===t.which&&!t.shiftKey)return e("#step3InputForm").form("submit"),t.preventDefault(),!1}),e("#step3InputForm").form({inline:!0,on:"blur"}),e("#textAreaStep3SignedTransaction").blur(function(){e("#step3InputForm").form("get value","textAreaStep3SignedTransaction")?e("#step3InputForm").find(".error").removeClass("error").find(".prompt").remove():s(!0)}),e("#step3InputForm").submit(function(t){t.preventDefault(),e("#btnSendTransaction").hasClass("disabled")||e("#btnSendTransaction").hasClass("loading")||e("#step3Input").hasClass("error")||(o(),e("#btnSendTransaction").addClass("loading disabled"),setTimeout(r,50))}),e("#textAreaStep3SignedTransaction").focus(t=>e(t.target).select()),e("#bundleHashSuccess").click(t=>e(t.target).select()),e("#bundleHashDuplicate").click(t=>e(t.target).select()),e("#confirmFromAddress").focus(t=>e(t.target).select()),e("#confirmToAddress").focus(t=>e(t.target).select()),e("#confirmRemainderAddress").focus(t=>e(t.target).select()),e(".formLabel, .checksum").popup(),e(".ui.accordion").accordion()}(jQuery,window)},{}],6:[function(e,t,n){!function(e,t){t.onload=function(){setTimeout(function(){e("#step1Div").transition({animation:"fade left",duration:"800ms"})},100),setTimeout(function(){e("#step2Div").transition({animation:"fade left",duration:"800ms"})},200),setTimeout(function(){e("#step3Div").transition({animation:"fade left",duration:"800ms"})},300),setTimeout(function(){e("#footer").transition({animation:"fade left",duration:"800ms"})},400)},e(".close.icon").click(function(){e(this).parent().transition("fade")}),e("#githubLink").click(function(){t.open("https://github.com/looploooop/iota-send-offline","_blank")}),e("#faqModal").modal({centered:!1,blurring:!0}),e("#step1ribbon, #step2ribbon, #step3ribbon").click(()=>e("#faqModal").modal("show")),e("#faq").click(()=>e("#faqModal").modal("show"))}(jQuery,window),window.twapi="https://api.tangle-worker.net",window.workerTagPrefix="TANGLEWORKER",window.remainderTag="IOTAOFFLINEREMAINDER9999999",window.defaultTag="IOTAOFFLINE9999999999999999",window.bundleUrl="https://iotasear.ch/bundle/",window.addressUrl="https://iotasear.ch/address/",window.getPrice=function(e,t){$.ajax({type:"get",url:"https://api.bitfinex.com/v2/tickers?symbols=tIOTUSD",dataType:"json",beforeSend:function(t){e.push(t)},complete:function(t){e.remove(t)},success:function(e){let n="";e.length>0&&(n=e[0][7]/1e3/1e3),t(null,n)},error:function(e,n){t(n)}})},window.iotaToUSD=function(e,t){if(t){return(t*e).toLocaleString("en-US",{style:"currency",currency:"USD"})}return"--"},window.formatIota=function(e){const t=new window.IOTA;let n="i";return e>=1e3&&(e=t.utils.convertUnits(e,n,"Ki"),n="Ki"),e>=1e3&&(e=t.utils.convertUnits(e,n,"Mi"),n="Mi"),e>=1e3&&(e=t.utils.convertUnits(e,"Mi","Gi"),n="Gi"),e>=1e3&&(e=t.utils.convertUnits(e,"Gi","Ti"),n="Ti"),(e=Math.round(100*e)/100)+" "+n},window.createXhrPool=function(){let e=[];return e.abortAll=function(){$(this).each(function(e,t){t.abort()}),e=[]},e.remove=function(e){var t=this.indexOf(e);t>-1&&this.splice(t,1)},e}},{}]},{},[2]);